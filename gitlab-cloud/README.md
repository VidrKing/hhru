# GitLab

- Существует отдельно от основной части проекта. Данные Ansible вложены в эту директорию (папка ansible). *Подробности в документации в директории ansible*.

- Пока лучший вариант создания инфраструктуры - запустить скрипт start-gitlab.tf (Если запускать не через скрипт start.sh в директории .. то необходимо сделать предварительно его исполняемым)

## Сам GitLab

- Разворачивается на одной ВМ через Ansible в Docker контейнере. Больше ВМ не поддерживается, так как пока не реализована балансировка трафика через *Nginx*. Но в планах есть :)

- Для инициализации необходимо перейти во вложенную директорию ansible и запустить соответствующий плейбук.

- Домен GitLab: vidrking.ru (достпен, когда ВМ работает и диску на ВМ не плохо).

- Создаётся ВМ с заранее прописанным в vm-gl.tf ip-адресом, на который привязан домен *vidrking.ru*. Есть возможность провалиться в ВМ по ssh, который можно найти в создаваемой при *terraform apply* директории *ssh-key*. Это нужно знать, так как возможны проблемы с диском ВМ, когда к нему стучится раннер.

- Есть несколько вариантов бекапов данных создаваемого репозитория.

## Раннеры

- Необходимо запускать создание ручками при помощи запуска плейбука под раннер с указанием нужной переменной для работы плейбука.
*Подробности в документации в директории ansible*.

- Одна ВМ *(Проблема с временными ip у ВМ решается)*, на которой 2 раннера: Bash и Docker. Пока сделать больше ВМ сложновато, проблема с ключом, который передаётся при запуске плейбука установки раннера. Особых проблем нет, просто сначала стоит изменить ситуацию с ручным запуском установки раннера и с проблемой диска ВМ типа gl, и лишь затем реализовывать масштабирование.


## P.s.

- Более подробные пояснения находятся в комментариях в коде