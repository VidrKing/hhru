# Инфраструктура через Terraform

- Сначала запускается скрипт start-terraform.sh, который настраивает Terraform и создаёт необходимый минимум для его работы

- Все шаблоны создаваемых через Terraform файлов лежат в директории template (за исключением файла ansible.cfg, на данный момент его шаблон лежит в файле ansible-file.tf)

- Сохранение статуса *Terraform* в облаке отключено, из-за проблем на стороне провайдера (AWS обновила свой S3, а провайдер пока не изменила служебные поля под эти изменения, если верить интернету)

- Для развёртывания ingress нужно иметь уже подготовленный домен и ip-адрес (комментарии взяты из alb-script.tpl из директории template: *Настраиваем ресурс YC DNS под наш домен (заранее купил домен, зарезервировал ip адрес под него и настроил DNS для домена на "ns1.yandexcloud.net" и "ns2.yandexcloud.net"*)

- Terraform создаёт k8s кластер с нодами в Yandex Cloud через их ресурс Yandex Managed Service for Kubernetes

- Terraform создаёт базу PostgreSQL в Yandex Cloud через их ресурс Yandex Managed Service for PostgreSQL

- Terraform создаёт репозиторий для Docker контейнеров в Yandex Cloud через их ресурс Yandex Container Registry и загружает созданные образы туда

- Terraform создаёт 3 типа ВМ. На данный момент они больше не нужны. Но они используются как песочница, поэтому не убраны из проекта. ТАкже Terraform настраивает Ansible в директории ../ansible под все созданные ВМ. P.s. Директория ..ansible/ находится в .gitignore. Если в неё что-либо добавлять важное, то надо .gitignore переписать

## P.s.

- Более подробные пояснения находятся в комментариях в коде